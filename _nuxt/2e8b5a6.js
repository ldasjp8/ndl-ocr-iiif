(window.webpackJsonp=window.webpackJsonp||[]).push([[15,8,10],{1119:function(e,t){},1121:function(e,t){},1296:function(e,t,n){"use strict";n.r(t);n(93),n(36),n(26),n(41),n(29),n(20),n(9),n(45),n(48),n(35);var r=n(21),o=n(32),c=n(31),l=n(47),f=n(43),h=n(30),v=n(14),d=(n(74),n(18),n(4),n(34),n(465));function m(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){l=!0,o=e},f:function(){try{c||null==n.return||n.return()}finally{if(l)throw o}}}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var o=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(f.a)(this,n)}}var j=function(e,t,n,desc){var r,o=arguments.length,c=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"===("undefined"==typeof Reflect?"undefined":Object(v.a)(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(c=(o<3?r(c):o>3?r(t,n,c):r(t,n))||c);return o>3&&c&&Object.defineProperty(t,n,c),c},O=n(1114),x=function(e){Object(l.a)(f,e);var t,n=w(f);function f(){var e;return Object(o.a)(this,f),(e=n.apply(this,arguments)).page=e.$route.query.page?Number(e.$route.query.page):1,e.id=e.$route.params.id,e.manifest="",e.element=null,e.xml=null,e.items=[],e.facsMap={},e}return Object(c.a)(f,[{key:"updatePage",value:function(e){this.page=e}},{key:"watchPage",value:function(e){e&&(this.facs=null,this.showPage(),this.$router.push(this.localePath({name:"id-tei",params:{id:this.id},query:{page:e}})))}},{key:"facs",get:function(){return this.$store.getters.getFacs},set:function(e){this.$store.commit("setFacs",e)}},{key:"xywh",get:function(){var e=this.facs,t=this.facsMap;return e&&t&&t[e]?t[e]:null}},{key:"move",value:function(e){this.page=Number(this.page)+e}},{key:"created",value:(t=Object(r.a)(regeneratorRuntime.mark((function e(){var t,n,r,o,data,c,l,i,f,h,v,d,y,w,j,O,x,R,P;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.id,this.manifest="https://www.dl.ndl.go.jp/api/iiif/".concat(t,"/manifest.json"),n="https://ocr.aws.ldas.jp/v1/tei/".concat(t,".xml"),e.next=5,this.$axios.$get(n);case 5:for(r=e.sent,o=new DOMParser,data=o.parseFromString(r,"text/xml"),this.xml=data,c=data.querySelectorAll("div[n]"),l=[],i=0;i<c.length;i++)l.push(i+1);this.items=l,this.showPage(),f=data.querySelectorAll("zone"),h={},v=m(f);try{for(v.s();!(d=v.n()).done;)y=d.value,w=y.getAttribute("xml:id"),j=Number(y.getAttribute("ulx")),O=Number(y.getAttribute("uly")),x=Number(y.getAttribute("lrx"))-j,R=Number(y.getAttribute("lry"))-O,P={x:j,y:O,w:x,h:R},h[w]=P}catch(e){v.e(e)}finally{v.f()}this.facsMap=h;case 19:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"conv2json",value:function(e){e=(new XMLSerializer).serializeToString(e);var t=O.xml2json(e),data=JSON.parse(t);return data=data.elements[0]}},{key:"showPage",value:function(){var e=Number(this.page),div=this.xml.querySelector('div[n="'.concat(e,'"]')),data=this.conv2json(div);this.element=data}}]),f}(d.Vue);j([Object(d.Watch)("page")],x.prototype,"watchPage",null);var R=x=j([Object(d.Component)({components:{}})],x),P=n(81),k=n(99),A=n.n(k),_=n(436),S=n(1112),$=n(437),C=n(201),E=n(1113),N=n(1289),component=Object(P.a)(R,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-container",{staticClass:"mt-5 mb-10",attrs:{fluid:""}},[n("v-row",{attrs:{align:"center"}},[n("v-col",{attrs:{cols:"2"}},[n("v-text-field",{attrs:{dense:"",outlined:"","hide-details":""},model:{value:e.page,callback:function(t){e.page=t},expression:"page"}})],1),e._v(" "),n("v-col",[n("div",[e._v("/ "+e._s(e.items.length)+" ページ")])]),e._v(" "),n("v-col",[n("v-btn",{staticClass:"ma-1",attrs:{disabled:e.page<2},on:{click:function(t){return e.move(-1)}}},[n("v-icon",[e._v("mdi-arrow-left")])],1),e._v(" "),n("v-btn",{staticClass:"ma-1",attrs:{disabled:e.page>e.items.length-1},on:{click:function(t){return e.move(1)}}},[n("v-icon",[e._v("mdi-arrow-right")])],1)],1)],1),e._v(" "),n("v-row",[n("v-col",[e.element?n("TeiElement",{attrs:{element:e.element}}):e._e()],1),e._v(" "),n("v-col",[n("Osd",{attrs:{height:"600",width:"100%",manifest:e.manifest,page:e.page,xywh:e.xywh},on:{page:e.updatePage}})],1)],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports;A()(component,{TeiElement:n(518).default,Osd:n(849).default}),A()(component,{VBtn:_.a,VCol:S.a,VContainer:$.a,VIcon:C.a,VRow:E.a,VTextField:N.a})},518:function(e,t,n){"use strict";n.r(t);n(93);var r=n(32),o=n(31),c=n(47),l=n(43),f=n(30),h=n(14),v=(n(18),n(4),n(26),n(465));function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(f.a)(e);if(t){var o=Object(f.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(l.a)(this,n)}}var m=function(e,t,n,desc){var r,o=arguments.length,c=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"===("undefined"==typeof Reflect?"undefined":Object(h.a)(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(c=(o<3?r(c):o>3?r(t,n,c):r(t,n))||c);return o>3&&c&&Object.defineProperty(t,n,c),c},y=function(e){Object(c.a)(n,e);var t=d(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"getComponent",value:function(element){return"lb"===element.name?"br":"ab"===element.name?"tei-ab":"span"}}]),n}(v.Vue);m([Object(v.Prop)({})],y.prototype,"element",void 0);var w=y=m([Object(v.Component)({components:{},name:"TeiElement"})],y),j=n(81),component=Object(j.a)(w,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n(e.getComponent(e.element),{tag:"component",attrs:{element:e.element}},[e.element.text?[e._v("\n    "+e._s(e.element.text)+"\n  ")]:[e._l(e.element.elements,(function(e,t){return[n("TeiElement",{key:t,attrs:{element:e}})]}))]],2)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{TeiElement:n(518).default})},849:function(e,t,n){"use strict";n.r(t);n(93),n(36),n(26),n(41),n(29),n(20),n(9),n(45),n(48),n(35);var r=n(21),o=n(32),c=n(31),l=n(47),f=n(43),h=n(30),v=n(14),d=(n(74),n(18),n(4),n(34),n(465)),m=n(605),y=n.n(m);function w(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return j(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){l=!0,o=e},f:function(){try{c||null==n.return||n.return()}finally{if(l)throw o}}}}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(h.a)(e);if(t){var o=Object(h.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(f.a)(this,n)}}var x=function(e,t,n,desc){var r,o=arguments.length,c=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,n):desc;if("object"===("undefined"==typeof Reflect?"undefined":Object(v.a)(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,desc);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(c=(o<3?r(c):o>3?r(t,n,c):r(t,n))||c);return o>3&&c&&Object.defineProperty(t,n,c),c},R=function(e){Object(l.a)(f,e);var t,n=O(f);function f(){var e;return Object(o.a)(this,f),(e=n.apply(this,arguments)).viewer=null,e}return Object(c.a)(f,[{key:"mounted",value:(t=Object(r.a)(regeneratorRuntime.mark((function e(){var t,n,r,o,c,l,canvas,f,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.manifest,n=[],e.next=4,this.$axios.$get(t);case 4:r=e.sent,o=r.sequences[0].canvases,c=w(o);try{for(c.s();!(l=c.n()).done;)canvas=l.value,n.push(canvas.images[0].resource.service["@id"]+"/info.json")}catch(e){c.e(e)}finally{c.f()}f=y()({sequenceMode:!0,id:"openseadragon",tileSources:n,initialPage:Number(this.page)-1}),this.viewer=f,h=this,f.addHandler("page",(function(e){h.$emit("page",e.page+1)}));case 12:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"watchPage",value:function(e){e&&this.viewer.goToPage(Number(e)-1)}},{key:"watchXywh",value:function(e){if(e){var t=this.viewer.world.getItemAt(0).source.width,n=new y.a.Rect(e.x/t,e.y/t,e.w/t,e.h/t);this.viewer.viewport.fitBounds(n)}}}]),f}(d.Vue);x([Object(d.Prop)({default:1})],R.prototype,"page",void 0),x([Object(d.Prop)({default:600})],R.prototype,"height",void 0),x([Object(d.Prop)({default:"100%"})],R.prototype,"width",void 0),x([Object(d.Prop)({})],R.prototype,"manifest",void 0),x([Object(d.Prop)({})],R.prototype,"xywh",void 0),x([Object(d.Watch)("page")],R.prototype,"watchPage",null),x([Object(d.Watch)("xywh")],R.prototype,"watchXywh",null);var P=R=x([Object(d.Component)({components:{}})],R),k=n(81),component=Object(k.a)(P,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{style:"background-color: black; height: "+e.height+"px; width: "+e.width+";",attrs:{id:"openseadragon"}})])}),[],!1,null,null,null);t.default=component.exports}}]);